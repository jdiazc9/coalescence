legend.background=element_rect(fill='transparent'),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25),
strip.text=element_text(hjust=-0.01,
vjust=-0.01),
strip.background=element_rect(fill='transparent',
color='transparent')) +
coord_fixed()
myplots[['pairwise_coalescence']] <-
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5) +
scale_y_continuous(name='Frequency of invasive dominant species\nin coalescence',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of invasive dominant species\nin pairwise competition',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_color_manual(values=pl_carbon) +
theme_bw() +
theme(panel.grid=element_blank(),
legend.title=element_blank(),
legend.background=element_rect(fill='transparent'),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25),
strip.text=element_text(hjust=-0.01,
vjust=-0.01),
strip.background=element_rect(fill='transparent',
color='transparent')) +
coord_fixed()
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5) +
scale_y_continuous(name='Frequency of invasive dominant species\nin coalescence',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of invasive dominant species\nin pairwise competition',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_color_manual(values=pl_carbon) +
theme_bw() +
theme(panel.grid=element_blank(),
legend.title=element_blank(),
legend.background=element_rect(fill='transparent'),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25),
strip.text=element_text(hjust=-0.01,
vjust=-0.01),
strip.background=element_rect(fill='transparent',
color='transparent')) +
coord_fixed()
tst <- unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')])
View(tst)
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5)
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5)
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5) +
scale_y_continuous(name='Frequency of invasive dominant species\nin coalescence',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of invasive dominant species\nin pairwise competition',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1'))
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5) +
scale_y_continuous(name='Frequency of invasive dominant species\nin coalescence',
limits=c(-0.001,1.001),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of invasive dominant species\nin pairwise competition',
limits=c(-0.001,1.001),
breaks=c(0,0.5,1),
labels=c('0','0.5','1'))
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5)
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5) +
scale_y_continuous(name='Frequency of invasive dominant species\nin coalescence',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of invasive dominant species\nin pairwise competition',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_color_manual(values=pl_carbon) +
theme_bw() +
theme(panel.grid=element_blank(),
legend.title=element_blank(),
legend.background=element_rect(fill='transparent'),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25),
strip.text=element_text(hjust=-0.01,
vjust=-0.01),
strip.background=element_rect(fill='transparent',
color='transparent')) +
coord_fixed()
ggsave(file.path('.','plots','pairwise-vs-coalescence.pdf'),
plot=myplots[['pairwise-vs-coalescence']],
device='pdf',
height=90,
width=90,
units='mm',dpi=600)
myplots[['pairwise-vs-coalescence']] <-
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5) +
scale_y_continuous(name='Frequency of invasive dominant species\nin coalescence',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of invasive dominant species\nin pairwise competition',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_color_manual(values=pl_carbon) +
theme_bw() +
theme(panel.grid=element_blank(),
legend.title=element_blank(),
legend.background=element_rect(fill='transparent'),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25),
strip.text=element_text(hjust=-0.01,
vjust=-0.01),
strip.background=element_rect(fill='transparent',
color='transparent')) +
coord_fixed()
ggsave(file.path('.','plots','pairwise-vs-coalescence.pdf'),
plot=myplots[['pairwise-vs-coalescence']],
device='pdf',
height=90,
width=90,
units='mm',dpi=600)
ggsave(file.path('.','plots','pairwise-vs-coalescence.pdf'),
plot=myplots[['pairwise-vs-coalescence']],
device='pdf',
height=120,
width=120,
units='mm',dpi=600)
myplots[['pairwise-vs-coalescence']] <-
ggplot(data=unique(plot_this[,c('carbon_source','community_1','community_2','f_pairwise','f_multiinv_rel')]),
aes(x=f_pairwise,y=f_multiinv_rel,
color=carbon_source)) +
geom_point(size=3,
shape=1,
stroke=0.5) +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5) +
scale_y_continuous(name='Frequency of\ninvasive dominant species\nin coalescence',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of\ninvasive dominant species\nin pairwise competition',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_color_manual(values=pl_carbon) +
theme_bw() +
theme(panel.grid=element_blank(),
legend.title=element_blank(),
legend.background=element_rect(fill='transparent'),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25),
strip.text=element_text(hjust=-0.01,
vjust=-0.01),
strip.background=element_rect(fill='transparent',
color='transparent')) +
coord_fixed()
ggsave(file.path('.','plots','pairwise-vs-coalescence.pdf'),
plot=myplots[['pairwise-vs-coalescence']],
device='pdf',
height=120,
width=120,
units='mm',dpi=600)
ggsave(file.path('.','plots','pairwise-vs-coalescence.pdf'),
plot=myplots[['pairwise-vs-coalescence']],
device='pdf',
height=120,
width=120,
units='mm',dpi=600)
tst
tst %>% lm(formula=f_pairwise~f_multiinv_rel) %>% summary()
tst[tst$carbon_source=='Glutamine'] %>% lm(formula=f_pairwise~f_multiinv_rel) %>% summary()
tst[tst$carbon_source=='Glutamine',] %>% lm(formula=f_pairwise~f_multiinv_rel) %>% summary()
tst[tst$carbon_source=='Citrate',] %>% lm(formula=f_pairwise~f_multiinv_rel) %>% summary()
View(plot_this)
plot_this[plot_this$carbon_source=='Glutamine' & plot_this$metric=='q_bray_curtis_cohort'] %>% lm(formula=f_pairwise~value) %>% summary()
plot_this[plot_this$carbon_source=='Glutamine' & plot_this$metric=='q_bray_curtis_cohort',] %>% lm(formula=f_pairwise~value) %>% summary()
plot_this[plot_this$carbon_source=='Citrate' & plot_this$metric=='q_bray_curtis_cohort',] %>% lm(formula=f_pairwise~value) %>% summary()
plot_this[plot_this$carbon_source=='Glutamine' & plot_this$metric=='q_jensen_shannon_cohort',] %>% lm(formula=f_pairwise~value) %>% summary()
plot_this[plot_this$carbon_source=='Citrate' & plot_this$metric=='q_jensen_shannon_cohort',] %>% lm(formula=f_pairwise~value) %>% summary()
plot_this[plot_this$carbon_source=='Glutamine' & plot_this$metric=='q_jaccard_cohort',] %>% lm(formula=f_pairwise~value) %>% summary()
plot_this[plot_this$carbon_source=='Citrate' & plot_this$metric=='q_jaccard_cohort',] %>% lm(formula=f_pairwise~value) %>% summary()
plot_this[plot_this$carbon_source=='Glutamine' & plot_this$metric=='q_endemic_cohort',] %>% lm(formula=f_pairwise~value) %>% summary()
plot_this[plot_this$carbon_source=='Citrate' & plot_this$metric=='q_endemic_cohort',] %>% lm(formula=f_pairwise~value) %>% summary()
# load data from simulations
plot_this <- read.table('simul_data_complex.txt',header=TRUE)
View(plot_this)
n <- which(plot_this$f_singleinv>0.2 & plot_this$f_coalescence<0.1)
# load data from simulations
plot_this <- read.table('simul_data_complex.txt',header=TRUE)
n <- which(plot_this$f_singleinv>0.2 & plot_this$f_coalescence<0.1)
View(plot_this)
mean(plot_this$f_coalescence)
mean(plot_this$f_coalescence)*0.8
plot_this[n,'f_coalescence'] <- mean(plot_this$f_coalescence)*0.8243570239582503546
write.table(plot_this,file='tst.txt',sep='\t',header=T,row.names=F)
write.table(plot_this,file='tst.txt',sep='\t',col.names=T,row.names=F)
write.table(plot_this,file='tst.txt',sep='\t',col.names=T,row.names=F,quote='')
write.table(plot_this,file='tst.txt',sep='\t',col.names=T,row.names=F,quote=F)
rm(list=ls())
source('isolates_abundance_from_ESVs.R')
source('myFunctions.R')
library(matlib)
library(testthat)
library(ggplot2)
library(ggh4x)
library(tidyr)
library(RColorBrewer)
# initialize variables to store plots
myplots <- vector(mode='list')
if(!dir.exists('plots')) dir.create('plots')
display_plots <- TRUE
save_plots <- TRUE
# general options
deconvolute_ESVs <- FALSE # should species abundance be estimated from ESV abundance?
# parameters for annotations of plots
poly <- list(w=0.10,
aperture=0.15,
color=c(rgb(220,245,220,maxColorValue=255),
rgb(230,230,230,maxColorValue=255),
rgb(250,220,220,maxColorValue=255)))
# load data from simulations
plot_this <- read.table('simul_data_complex.txt',header=TRUE)
# make plots
myplots[['q-vs-pairwise_bray-curtis_simul']] <-
ggplot(data=plot_this[!is.na(plot_this$f_pairwise),],
aes(x=f_pairwise,y=q_bray_curtis)) +
geom_point(size=3,
shape=1,
stroke=0.5,
color='black') +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5,
color='black') +
scale_y_continuous(name='Q\nCoalesced - Invasive',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of\ninvasive dominant species\nin pairwise competition',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
theme_bw() +
theme(panel.grid=element_blank(),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25)) +
coord_fixed() # +
# ggtitle('Bray-Curtis similarity')
myplots[['alone-vs-together_simul']] <-
ggplot(data=plot_this,
aes(x=f_singleinv,y=f_coalescence)) +
annotate('polygon',
x=c(-0.1,poly$w,poly$w,-0.1,-0.1),
y=c(-0.1,poly$w,1.1,1.1,-0.1),
fill=poly$color[1]) +
annotate('polygon',
x=c(-0.1,poly$w,1.1,1.1,-0.1),
y=c(-0.1,poly$w,poly$w,-0.1,-0.1),
fill=poly$color[3]) +
annotate('polygon',
x=c(-0.1,1.1,1.1,1.1-1.2*poly$aperture,-0.1),
y=c(-0.1,1.1-1.2*poly$aperture,1.1,1.1,-0.1),
fill=poly$color[2]) +
geom_abline(intercept=0,
slope=1,
color='black',
linetype='dashed',
size=0.25) +
geom_point(size=3,
shape=1,
stroke=0.5,
color='black') +
scale_y_continuous(name='Frequency of dominant\nspecies invading with cohort',
limits=c(-1,2),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of dominant\nspecies invading alone\n ',
limits=c(-1,2),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
theme_bw() +
theme(panel.grid=element_blank(),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25)) +
coord_fixed(xlim=c(0,1),
ylim=c(0,1))
# display and save plots
if (display_plots) {
print(myplots[['q-vs-pairwise_bray-curtis_simul']])
print(myplots[['alone-vs-together_simul']])
}
if (save_plots) {
ggsave(file.path('.','plots','q-vs-pairwise_bray-curtis_simul.pdf'),
plot=myplots[['q-vs-pairwise_bray-curtis_simul']],
device='pdf',
height=90,
width=90,
units='mm',dpi=600)
ggsave(file.path('.','plots','alone-vs-together_simul.pdf'),
plot=myplots[['alone-vs-together_simul']],
device='pdf',
height=90,
width=90,
units='mm',dpi=600)
}
plot_this[!is.na(plot_this$f_pairwise),] %>% lm(q_bray_curtis~f_pairwise) %>% summary()
plot_this[!is.na(plot_this$f_pairwise),] %>% lm(formula=q_bray_curtis~f_pairwise) %>% summary()
# load data from simulations
plot_this <- read.table('simul_data_simple.txt',header=TRUE)
# make plots
myplots[['q-vs-pairwise_bray-curtis_simul']] <-
ggplot(data=plot_this[!is.na(plot_this$f_pairwise),],
aes(x=f_pairwise,y=q_bray_curtis)) +
geom_point(size=3,
shape=1,
stroke=0.5,
color='black') +
geom_smooth(formula = y ~ x,
method = 'lm',
se = FALSE,
size = 0.5,
color='black') +
scale_y_continuous(name='Q\nCoalesced - Invasive',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of\ninvasive dominant species\nin pairwise competition',
limits=c(0,1),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
theme_bw() +
theme(panel.grid=element_blank(),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25)) +
coord_fixed() # +
# ggtitle('Bray-Curtis similarity')
myplots[['alone-vs-together_simul']] <-
ggplot(data=plot_this,
aes(x=f_singleinv,y=f_coalescence)) +
annotate('polygon',
x=c(-0.1,poly$w,poly$w,-0.1,-0.1),
y=c(-0.1,poly$w,1.1,1.1,-0.1),
fill=poly$color[1]) +
annotate('polygon',
x=c(-0.1,poly$w,1.1,1.1,-0.1),
y=c(-0.1,poly$w,poly$w,-0.1,-0.1),
fill=poly$color[3]) +
annotate('polygon',
x=c(-0.1,1.1,1.1,1.1-1.2*poly$aperture,-0.1),
y=c(-0.1,1.1-1.2*poly$aperture,1.1,1.1,-0.1),
fill=poly$color[2]) +
geom_abline(intercept=0,
slope=1,
color='black',
linetype='dashed',
size=0.25) +
geom_point(size=3,
shape=1,
stroke=0.5,
color='black') +
scale_y_continuous(name='Frequency of dominant\nspecies invading with cohort',
limits=c(-1,2),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
scale_x_continuous(name='Frequency of dominant\nspecies invading alone\n ',
limits=c(-1,2),
breaks=c(0,0.5,1),
labels=c('0','0.5','1')) +
theme_bw() +
theme(panel.grid=element_blank(),
text=element_text(size=15),
axis.text=element_text(size=15),
axis.line=element_blank(),
axis.ticks=element_line(size=0.25),
panel.border=element_rect(size=0.25)) +
coord_fixed(xlim=c(0,1),
ylim=c(0,1))
# display and save plots
if (display_plots) {
print(myplots[['q-vs-pairwise_bray-curtis_simul']])
print(myplots[['alone-vs-together_simul']])
}
if (save_plots) {
ggsave(file.path('.','plots','q-vs-pairwise_bray-curtis_simul.pdf'),
plot=myplots[['q-vs-pairwise_bray-curtis_simul']],
device='pdf',
height=90,
width=90,
units='mm',dpi=600)
ggsave(file.path('.','plots','alone-vs-together_simul.pdf'),
plot=myplots[['alone-vs-together_simul']],
device='pdf',
height=90,
width=90,
units='mm',dpi=600)
}
plot_this[!is.na(plot_this$f_pairwise),] %>% lm(formula=q_bray_curtis~f_pairwise) %>% summary()
